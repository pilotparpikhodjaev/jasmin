#
# Jasmin SMS Gateway OTP Configuration
# Optimized for OTP/transactional SMS with billing integration
#

[smpp-server]
# SMPP Server for client connections
port = 2775
billing_feature = True
dlr_expiry = 86400
log_level = INFO
log_file = /var/log/jasmin/default-smpps_01.log
log_rotate = midnight
log_format = %(asctime)s %(levelname)-8s %(process)d %(message)s
log_date_format = %Y-%m-%d %H:%M:%S
log_privacy = False

[smpp-server-pb]
# SMPP Server Perspective Broker for management
port = 14000
authentication = True
admin_username = smppsadmin
admin_password = e97ab122faa16beea8682d84f3d2eea4
log_level = INFO
log_file = /var/log/jasmin/smpp-server-pb.log

[client-management]
# SMPP Client connector management
store_path = /etc/jasmin/store
port = 8989
authentication = True
admin_username = cmadmin
admin_password = e1c5136acafb7016bc965597c992eb82
log_level = INFO
log_file = /var/log/jasmin/smppclient-manager.log
pickle_protocol = 2

[service-smppclient]
# SMPP Client services
log_level = INFO
log_file = /var/log/jasmin/service-smppclients.log

[sm-listener]
# CRITICAL: Enable submit_sm_resp publishing for billing integration
publish_submit_sm_resp = True

# Retry configuration for failed submissions
submit_error_retrial = {
    'ESME_RSYSERR': {'count': 2, 'delay': 30},
    'ESME_RTHROTTLED': {'count': 20, 'delay': 30},
    'ESME_RMSGQFUL': {'count': 2, 'delay': 180},
    'ESME_RINVSCHED': {'count': 2, 'delay': 300},
}

# Message queue aging
submit_max_age_smppc_not_ready = 1200
submit_retrial_delay_smppc_not_ready = 30

log_level = INFO
log_file = /var/log/jasmin/messages.log
log_rotate = midnight
log_format = %(asctime)s %(levelname)-8s %(process)d %(message)s
log_date_format = %Y-%m-%d %H:%M:%S
log_privacy = False

[dlr]
# DLR configuration
pid = main
dlr_lookup_retry_delay = 10
dlr_lookup_max_retries = 2

# CRITICAL: Send receipt to SMPP clients on submit_sm_resp success
smpp_receipt_on_success_submit_sm_resp = True

log_level = INFO
log_file = /var/log/jasmin/messages.log
log_rotate = midnight
log_format = %(asctime)s %(levelname)-8s %(process)d %(message)s
log_date_format = %Y-%m-%d %H:%M:%S
log_privacy = False

[amqp-broker]
# RabbitMQ connection settings (overridden by environment variables in Docker)
host = 127.0.0.1
vhost = /
spec = /etc/jasmin/resource/amqp0-9-1.xml
port = 5672
username = guest
password = guest
heartbeat = 0

connection_loss_retry = True
connection_failure_retry = True
connection_loss_retry_delay = 10
connection_loss_failure_delay = 10

log_level = INFO
log_file = /var/log/jasmin/amqp-client.log

[http-api]
# HTTP API for SMS submission
port = 8990
billing_feature = True
long_content_max_parts = 5
long_content_split = udh

access_log = /var/log/jasmin/http-access.log
log_level = INFO
log_file = /var/log/jasmin/http-api.log
log_format = %(asctime)s %(levelname)-8s %(process)d %(message)s
log_date_format = %Y-%m-%d %H:%M:%S
log_privacy = False

[router]
# Router for message routing
store_path = /etc/jasmin/store
persistence_timer_secs = 60
port = 8988
authentication = True
admin_username = radmin
admin_password = 82a606ca5a0deea2b5777756788af5c8
log_level = INFO
log_file = /var/log/jasmin/router.log
pickle_protocol = 2

[deliversm-thrower]
# HTTP/SMPP delivery for MO messages
http_timeout = 30
retry_delay = 30
max_retries = 3
log_level = INFO
log_file = /var/log/jasmin/deliversm-thrower.log

[dlr-thrower]
# HTTP/SMPP delivery for DLR
http_timeout = 30
retry_delay = 30
max_retries = 3
dlr_pdu = deliver_sm
log_level = INFO
log_file = /var/log/jasmin/dlr-thrower.log

[redis-client]
# Redis for DLR tracking and billing counters (overridden by environment variables in Docker)
host = 127.0.0.1
port = 6379
dbid = 0
password = None
poolsize = 10
log_level = INFO
log_file = /var/log/jasmin/redis-client.log

[jcli]
# Jasmin CLI management console
bind = 0.0.0.0
port = 1401
authentication = True
admin_username = jcliadmin
admin_password = 79e9b0aa3f3e7c53e916f7ac47439bcb
log_level = INFO
log_file = /var/log/jasmin/jcli.log

[interceptor-client]
# Interceptor client (if enabled with --enable-interceptor-client)
host = 127.0.0.1
port = 8987
username = iadmin
password = ipwd
